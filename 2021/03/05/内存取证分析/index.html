<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>内存取证分析 | Hui's Blog</title><script src="https://cdn.bootcss.com/valine/1.4.4/Valine.min.js"></script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Hui's Blog" type="application/atom+xml">
</head><body><header><nav><a href="/">Home</a><a href="/archives/">Archives</a></nav></header><main><article><div id="post-bg"><div id="post-title"><h1>内存取证分析</h1><hr></div><div id="post-content"><h2 id="volatility-工具介绍："><a href="#volatility-工具介绍：" class="headerlink" title="volatility 工具介绍："></a><strong>volatility 工具介绍：</strong></h2><p>Volatility是开源的内存取证工具，在Winodws,Linux,Mac,Android等平台使用，由python编写而成，支持各种操作系统。</p>
<h2 id="volatility-工具使用："><a href="#volatility-工具使用：" class="headerlink" title="volatility 工具使用："></a><strong>volatility 工具使用：</strong></h2><h3 id="获取内存镜像的摘要信息"><a href="#获取内存镜像的摘要信息" class="headerlink" title="获取内存镜像的摘要信息"></a>获取内存镜像的摘要信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw imageinfo</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102135222699.png" alt="image-20201102135222699"></p>
<blockquote>
<p>判断系统版本应该是Win7SP1x64</p>
</blockquote>
<h3 id="查看进程信息"><a href="#查看进程信息" class="headerlink" title="查看进程信息"></a>查看进程信息</h3><p>pslist可以直接列出运行的进程，如果进程已经结束，会在Exit列显示日期和时间，表明进程已经结束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 pslist</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102141316628.png" alt="image-20201102141316628"></p>
<h3 id="查看隐藏进程"><a href="#查看隐藏进程" class="headerlink" title="查看隐藏进程"></a>查看隐藏进程</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 pstree</span><br><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 psxview</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102154603111.png" alt="image-20201102154603111"></p>
<h3 id="列举缓存在内存的注册表"><a href="#列举缓存在内存的注册表" class="headerlink" title="列举缓存在内存的注册表"></a>列举缓存在内存的注册表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 hivelist</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102150810232.png" alt="image-20201102150810232"></p>
<h3 id="提取主机名"><a href="#提取主机名" class="headerlink" title="提取主机名"></a>提取主机名</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201115091150119.png" alt="image-20201115091150119"></p>
<h3 id="获取SAM表中的用户-："><a href="#获取SAM表中的用户-：" class="headerlink" title="获取SAM表中的用户 ："></a>获取SAM表中的用户 ：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102152225937.png" alt="image-20201102152225937"></p>
<h3 id="扫描内存中的文件"><a href="#扫描内存中的文件" class="headerlink" title="扫描内存中的文件"></a>扫描内存中的文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 filescan</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102151129039.png" alt="image-20201102151129039"></p>
<ul>
<li>filescan 也可以结合grep命令来进行筛选，比如</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 filescan | grep &quot;doc\|docx&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102151359619.png" alt="image-20201102151359619"></p>
<h3 id="提取内存中保留的cmd命令使用情况"><a href="#提取内存中保留的cmd命令使用情况" class="headerlink" title="提取内存中保留的cmd命令使用情况"></a>提取内存中保留的cmd命令使用情况</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 cmdline</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102151626278.png" alt="image-20201102151626278"></p>
<h3 id="提取出内存中记录的-当时正在运行的程序"><a href="#提取出内存中记录的-当时正在运行的程序" class="headerlink" title="提取出内存中记录的 当时正在运行的程序"></a>提取出内存中记录的 当时正在运行的程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.vmem --profile&#x3D;Win7SP1x64 userassist</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102152650474.png" alt="image-20201102152650474"></p>
<h3 id="提取网络连接情况"><a href="#提取网络连接情况" class="headerlink" title="提取网络连接情况"></a>提取网络连接情况</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 netscan</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102153001736.png" alt="image-20201102153001736"></p>
<h3 id="提取IE浏览器历史"><a href="#提取IE浏览器历史" class="headerlink" title="提取IE浏览器历史"></a>提取IE浏览器历史</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.raw --profile&#x3D;Win7SP1x64 iehistory</span><br></pre></td></tr></table></figure>



<h3 id="提取系统密码"><a href="#提取系统密码" class="headerlink" title="提取系统密码"></a>提取系统密码</h3><h4 id="1-直接hashdump"><a href="#1-直接hashdump" class="headerlink" title="1.直接hashdump"></a>1.直接hashdump</h4><p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-202011021542198622.png" alt="image-20201102154219862"></p>
<h4 id="2-从注册表获取"><a href="#2-从注册表获取" class="headerlink" title="2.从注册表获取"></a>2.从注册表获取</h4><ul>
<li>注册表 system 的 virtual 地址 </li>
<li>SAM 的 virtual 地址</li>
</ul>
<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102153454213.png" alt="image-20201102153454213"></p>
<ul>
<li>dump出来密码</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f mem.vmem --profile&#x3D;Win7SP1x64 hashdump -y （注册表 system 的 virtual 地址 ）-s （SAM 的 virtual 地址）</span><br><span class="line">volatility -f mem.vmen --profile&#x3D;Win7SP1x64 hashdump -y 0xfffff8a000024010 -s 0xfffff8a000867010</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/ey0rt/hexo_img/raw/master/image/image-20201102153714379.png" alt="image-20201102153714379"></p>
<div id="paginator"></div></div><div id="post-footer"><hr><a href="/2021/03/06/ATT&amp;CK%E7%BA%A2%E9%98%9F%E5%AE%9E%E6%88%98(%E4%B8%80)/">← Prev ATT&amp;CK红队实战(一)</a><span style="color: #fe2"> | </span><a href="/2020/10/27/%E5%AE%89%E5%85%A8%E6%9D%82%E9%A1%B9Misc%E7%AC%94%E8%AE%B0/">安全杂项Misc笔记 Next →</a><hr></div><div id="bottom-btn"><a id="to-index" href="#post-index" title="index">≡</a><a id="to-top" href="#post-title" title="to top">∧</a></div><div id="Valine"></div><script>new Valine({
 el: '#Valine'
 , appId: ''
 , appKey: ''
 , placeholder: '此条评论委托企鹅物流发送'
})</script></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/"> Dr.Hui</a></h1><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">15</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">20</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">6</span></div></section></div><div id="aside-block"></div><footer><nobr><span class="text-title">©</span><span class="text-content">1970 to 2020</span></nobr><wbr><nobr><span class="text-title">ICP</span><span class="text-content">——备案号——</span></nobr><wbr><wbr><nobr>published with&nbsp;<a target="_blank" rel="noopener" href="http://hexo.io">Hexo&nbsp;</a></nobr><wbr><nobr>Theme&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight&nbsp;</a></nobr><wbr><nobr>by&nbsp;<a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/arknights.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/10.1.2/highlight.min.js"></script></body></html>